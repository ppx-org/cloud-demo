<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title></title>

<link th:replace="common/fragment/common::common"/>
<link th:replace="common/fragment/common::validation"/>

<script type="text/javascript" th:inline="javascript">
$(function() {
	
});


function queryPage(pageNumber) {
	$("#pageNumber").val(pageNumber);
	showLoading();
	
	
	
	$.get([[@{/query/promo}]], $("#queryForm").serialize(), function(r) {
		refreshPageData(r);
		// promo
		$("#promoView").empty();
		for (var i = 0; i < r.promoList.length; i++) {
			$("#promoView").append('<a href="javascript:onPromo(' + r.promoList[i].gid + ')">' + r.promoList[i].arg + '(' + r.promoList[i].n + ')</a>');
		}
		if (r.promoList.length > 0 && $("#gId").val() != "") {
			$("#promoView").append('<a href="javascript:onPromo(\'\')">cancel</a>');
		}
		
		hideLoading();
	});
}

function query() {
	$("#gId").val("");
	queryPage(1);
}

function onPromo(gId) {
	$("#gId").val(gId);
	queryPage(1);
}

</script>

<style>
#catView a {
	padding-left:10px
}

.page-list-title {display: none;}
</style>

</head>

<body>

<ul id="myTab" class="nav nav-tabs" th:include="store/search/pre/preHead"></ul>
<script th:inline="javascript">$("#promo").tab('show')</script>

<div th:replace="common/fragment/common::pageList('DEMO_TEST')">
	<div th:fragment="queryFragment">
		<input type="hidden" id="gId" name="gId">
		<button type="button" class="btn btn-default btn-sm" onclick="query();"><span class="glyphicon glyphicon-search"></span>搜索</button>
	</div>
	
	<table th:fragment="listFragment">
	<tr>
	<td colspan="2">
		<table>
			<tr><td style="text-align: left;margin-left:10px">PPPPP<span id="promoView"></span></td></tr>
		</table>
	</td>
	</tr>
	
	<script id="pageTemplate" type="text/html">
	{{each arrayList as v i}}
	<tr>
		<td class="w-id">{{v.src}}</td>
		<td class="w-id">
			<div>{{v.t}}</div>
			<a href="/preSearch/promo?progId={{v.gid}}" target="_blank">{{v.arg}}</a>
		</td>
	</tr>
	{{/each}}
	</script>
	</table>
</div>




</body>
</html>

